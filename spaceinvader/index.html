<!doctype html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>hello phaser!</title>
        <script src="phaser.min.js"></script>
    </head>
    <body>

    <script type="text/javascript">

    window.onload = function() {

        var game = new Phaser.Game(800, 600, Phaser.AUTO, '', { preload: preload, create: create, update: update});
        var player;
        var shoot;
        var canShoot;
        function preload () {

            game.load.image('airplane', 'airplane.png');
            game.load.image('bullet','bullet.png');

        }

        function create () {
            game.physics.startSystem(Phaser.Physics.ARCADE);
            player = game.add.sprite(game.world.centerX, game.world.height - 50, 'airplane');
            player.scale.setTo(0.5,0.5);
            player.anchor.setTo(0.5, 0.5);
            game.physics.arcade.enable(player);

            player.body.bounce.y = 0.2;
            player.body.gravity.y = 300;
            player.body.collideWorldBounds = true;


            shoot = game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR);

            game.time.events.loop(Phaser.Timer.SECOND*0.3, allowShooting, this);
        }


        function allowShooting() {
            canShoot = true;
        }

        function update () {
            var cursors = game.input.keyboard.createCursorKeys();

            player.body.velocity.x = 0;

            if (cursors.left.isDown)
            {
                //  Move to the left
                player.body.velocity.x = -150;

            }
            else if (cursors.right.isDown)
            {
                //  Move to the right
                player.body.velocity.x = 150;

            }


            //  Allow the player to jump if they are touching the ground.
            if (cursors.up.isDown)
            {
                player.body.velocity.y = -350;
            }

            if (shoot.isDown && canShoot){

                var bullet = game.add.sprite(player.x, player.y, 'bullet');
                bullet.scale.setTo(0.5,0.5);
                bullet.anchor.setTo(0.5, 0.5);
                game.physics.arcade.enable(bullet);
                bullet.body.velocity.y = -1000;
                canShoot = false;
            }

        }
    };

    </script>

    </body>
</html>